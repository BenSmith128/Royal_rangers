# Verses sorted by words, longest to shortest

WITH vwc AS (
  SELECT
    Oal_v_num,
    Verse_KJV,
    ARRAY_LENGTH(
      SPLIT(
        REGEXP_REPLACE(
          TRIM(Verse_KJV),
          r'\s+',
          ' '
        ),
        ' '
      )
    ) AS word_count,
    SUM(
      ARRAY_LENGTH(
        SPLIT(
          REGEXP_REPLACE(
            TRIM(Verse_KJV),
            r'\s+',
            ' '
          ),
          ' '
        )
      )
    ) OVER () AS total_words
  FROM
    `your_table
),

cs AS (
  SELECT
    *,
    SUM(word_count) OVER (ORDER BY word_count DESC, Oal_v_num ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS running_word_sum,
    total_words / 5 AS daily_word_target
  FROM
    vwc
)

SELECT
  Oal_v_num,
  cs.Verse_KJV,
  word_count,
  CEIL(running_word_sum / daily_word_target) AS day_number
FROM
  cs
ORDER BY
  day_number ASC,
  word_count DESC
